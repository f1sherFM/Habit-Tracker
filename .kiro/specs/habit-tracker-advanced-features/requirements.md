# Документ Требований: Продвинутые Функции Habit-Tracker

## Введение

Данный документ описывает требования к добавлению продвинутых функций в Habit-Tracker: категории и теги, статистика и аналитика, комментарии к привычкам, и гибкий выбор периода отслеживания (до 30 дней).

## Глоссарий

- **Категория**: Группа привычек по типам (здоровье, учеба, работа и т.д.)
- **Тег**: Метка для быстрого поиска и фильтрации привычек
- **Статистика**: Числовые показатели выполнения привычек
- **Аналитика**: Визуализация и анализ данных о привычках
- **Комментарий**: Заметка пользователя к выполнению привычки
- **Период отслеживания**: Количество дней для отображения прогресса (1-30 дней)
- **Streak**: Количество дней подряд выполнения привычки

## Требования

### Требование 1: Категории Привычек

**Пользовательская История:** Как пользователь, я хочу организовать свои привычки по категориям, чтобы лучше управлять ими и видеть прогресс по каждой области жизни.

#### Критерии Приемки

1. КОГДА пользователь создает привычку, ТО Система ДОЛЖНА позволить выбрать категорию из предопределенного списка
2. КОГДА пользователь просматривает привычки, ТО Система ДОЛЖНА позволить фильтровать по категориям
3. КОГДА пользователь создает новую категорию, ТО Система ДОЛЖНА сохранить ее для будущего использования
4. КОГДА пользователь удаляет категорию, ТО Система ДОЛЖНА переместить привычки в категорию "Без категории"
5. Система ДОЛЖНА поддерживать минимум 10 предопределенных категорий (здоровье, учеба, работа, спорт, хобби, финансы, отношения, развитие, быт, другое)

### Требование 2: Теги для Привычек

**Пользовательская История:** Как пользователь, я хочу добавлять теги к привычкам, чтобы быстро находить связанные привычки и группировать их по интересам.

#### Критерии Приемки

1. КОГДА пользователь создает привычку, ТО Система ДОЛЖНА позволить добавить несколько тегов
2. КОГДА пользователь вводит тег, ТО Система ДОЛЖНА предложить автодополнение из существующих тегов
3. КОГДА пользователь нажимает на тег, ТО Система ДОЛЖНА показать все привычки с этим тегом
4. КОГДА пользователь удаляет привычку, ТО Система ДОЛЖНА удалить неиспользуемые теги
5. Система ДОЛЖНА ограничить максимум 5 тегов на одну привычку

### Требование 3: Статистика Привычек

**Пользовательская История:** Как пользователь, я хочу видеть статистику по своим привычкам, чтобы понимать свой прогресс и мотивироваться.

#### Критерии Приемки

1. КОГДА пользователь просматривает привычку, ТО Система ДОЛЖНА показать процент выполнения за выбранный период
2. КОГДА пользователь просматривает привычку, ТО Система ДОЛЖНА показать текущий streak (количество дней подряд)
3. КОГДА пользователь просматривает привычку, ТО Система ДОЛЖНА показать лучший streak за все время
4. КОГДА пользователь просматривает привычку, ТО Система ДОЛЖНА показать общее количество выполнений
5. КОГДА пользователь просматривает привычку, ТО Система ДОЛЖНА показать последний день выполнения

### Требование 4: Аналитика и Графики

**Пользовательская История:** Как пользователь, я хочу видеть графики прогресса по привычкам, чтобы визуально оценить свой прогресс.

#### Критерии Приемки

1. КОГДА пользователь открывает страницу аналитики, ТО Система ДОЛЖНА показать график выполнения привычек за выбранный период
2. КОГДА пользователь открывает страницу аналитики, ТО Система ДОЛЖНА показать сравнение прогресса по категориям
3. КОГДА пользователь открывает страницу аналитики, ТО Система ДОЛЖНА показать тепловую карту выполнения (как GitHub contributions)
4. КОГДА пользователь открывает страницу аналитики, ТО Система ДОЛЖНА показать топ-5 самых выполняемых привычек
5. КОГДА пользователь открывает страницу аналитики, ТО Система ДОЛЖНА позволить экспортировать данные в CSV

### Требование 5: Комментарии к Привычкам

**Пользовательская История:** Как пользователь, я хочу добавлять комментарии к выполнению привычек, чтобы отслеживать причины успехов и неудач.

#### Критерии Приемки

1. КОГДА пользователь отмечает привычку как выполненную, ТО Система ДОЛЖНА позволить добавить комментарий
2. КОГДА пользователь просматривает историю привычки, ТО Система ДОЛЖНА показать все комментарии с датами
3. КОГДА пользователь редактирует комментарий, ТО Система ДОЛЖНА сохранить время редактирования
4. КОГДА пользователь удаляет комментарий, ТО Система ДОЛЖНА удалить его из истории
5. Система ДОЛЖНА ограничить длину комментария до 500 символов

### Требование 6: Гибкий Период Отслеживания

**Пользовательская История:** Как пользователь, я хочу выбирать период отслеживания привычек (от 1 до 30 дней), чтобы видеть прогресс в удобном для меня масштабе.

#### Критерии Приемки

1. КОГДА пользователь открывает дашборд, ТО Система ДОЛЖНА позволить выбрать период от 1 до 30 дней
2. КОГДА пользователь выбирает период, ТО Система ДОЛЖНА обновить все графики и статистику
3. КОГДА пользователь выбирает период, ТО Система ДОЛЖНА сохранить выбор в профиле пользователя
4. КОГДА пользователь просматривает привычку, ТО Система ДОЛЖНА показать прогресс за выбранный период
5. Система ДОЛЖНА поддерживать предустановки: 7 дней, 14 дней, 30 дней, и кастомный период

### Требование 7: Интеграция Категорий и Тегов с Фильтрацией

**Пользовательская История:** Как пользователь, я хочу быстро фильтровать привычки по категориям и тегам, чтобы сосредоточиться на нужных мне привычках.

#### Критерии Приемки

1. КОГДА пользователь нажимает на категорию, ТО Система ДОЛЖНА показать только привычки этой категории
2. КОГДА пользователь нажимает на тег, ТО Система ДОЛЖНА показать только привычки с этим тегом
3. КОГДА пользователь применяет несколько фильтров, ТО Система ДОЛЖНА показать привычки, соответствующие всем фильтрам (AND логика)
4. КОГДА пользователь очищает фильтры, ТО Система ДОЛЖНА показать все привычки
5. КОГДА пользователь применяет фильтры, ТО Система ДОЛЖНА сохранить выбор в сессии

### Требование 8: Статистика по Категориям

**Пользовательская История:** Как пользователь, я хочу видеть статистику по каждой категории, чтобы понимать, в каких областях я прогрессирую лучше всего.

#### Критерии Приемки

1. КОГДА пользователь открывает страницу аналитики, ТО Система ДОЛЖНА показать среднее выполнение по каждой категории
2. КОГДА пользователь открывает страницу аналитики, ТО Система ДОЛЖНА показать количество привычек в каждой категории
3. КОГДА пользователь открывает страницу аналитики, ТО Система ДОЛЖНА показать тренд выполнения по категориям
4. КОГДА пользователь нажимает на категорию в аналитике, ТО Система ДОЛЖНА показать детальную статистику по этой категории
5. Система ДОЛЖНА позволить сравнивать статистику между категориями

### Требование 9: История Комментариев

**Пользовательская История:** Как пользователь, я хочу видеть полную историю комментариев к привычке, чтобы анализировать причины своих успехов и неудач.

#### Критерии Приемки

1. КОГДА пользователь открывает привычку, ТО Система ДОЛЖНА показать все комментарии в хронологическом порядке
2. КОГДА пользователь просматривает комментарий, ТО Система ДОЛЖНА показать дату и время добавления
3. КОГДА пользователь просматривает комментарий, ТО Система ДОЛЖНА показать, был ли он отредактирован
4. КОГДА пользователь ищет комментарии, ТО Система ДОЛЖНА позволить искать по тексту комментариев
5. Система ДОЛЖНА позволить фильтровать комментарии по датам

### Требование 10: Валидация Периода Отслеживания

**Пользовательская История:** Как система, я хочу валидировать период отслеживания, чтобы обеспечить корректность данных.

#### Критерии Приемки

1. КОГДА пользователь выбирает период, ТО Система ДОЛЖНА отклонить значения меньше 1 дня
2. КОГДА пользователь выбирает период, ТО Система ДОЛЖНА отклонить значения больше 30 дней
3. КОГДА пользователь выбирает период, ТО Система ДОЛЖНА отклонить нецелые числа
4. КОГДА пользователь выбирает период, ТО Система ДОЛЖНА вернуть описательное сообщение об ошибке
5. Система ДОЛЖНА использовать валидатор для проверки периода

### Требование 11: Валидация Комментариев

**Пользовательская История:** Как система, я хочу валидировать комментарии, чтобы обеспечить качество данных.

#### Критерии Приемки

1. КОГДА пользователь добавляет комментарий, ТО Система ДОЛЖНА отклонить пустые комментарии
2. КОГДА пользователь добавляет комментарий, ТО Система ДОЛЖНА отклонить комментарии длиннее 500 символов
3. КОГДА пользователь добавляет комментарий, ТО Система ДОЛЖНА санитизировать HTML теги
4. КОГДА пользователь добавляет комментарий, ТО Система ДОЛЖНА вернуть описательное сообщение об ошибке
5. Система ДОЛЖНА использовать валидатор для проверки комментариев

### Требование 12: Валидация Тегов

**Пользовательская История:** Как система, я хочу валидировать теги, чтобы обеспечить консистентность данных.

#### Критерии Приемки

1. КОГДА пользователь добавляет тег, ТО Система ДОЛЖНА отклонить пустые теги
2. КОГДА пользователь добавляет тег, ТО Система ДОЛЖНА отклонить теги длиннее 20 символов
3. КОГДА пользователь добавляет тег, ТО Система ДОЛЖНА отклонить более 5 тегов на привычку
4. КОГДА пользователь добавляет тег, ТО Система ДОЛЖНА преобразовать теги в нижний регистр
5. Система ДОЛЖНА использовать валидатор для проверки тегов

### Требование 13: Тестирование Категорий и Тегов

**Пользовательская История:** Как разработчик, я хочу иметь автоматические тесты для функций категорий и тегов, чтобы обеспечить надежность.

#### Критерии Приемки

1. Система ДОЛЖНА содержать тесты для создания категорий
2. Система ДОЛЖНА содержать тесты для добавления тегов к привычкам
3. Система ДОЛЖНА содержать тесты для фильтрации по категориям и тегам
4. Система ДОЛЖНА содержать тесты для удаления категорий и тегов
5. Система ДОЛЖНА содержать property-based тесты для валидации

### Требование 14: Тестирование Статистики и Аналитики

**Пользовательская История:** Как разработчик, я хочу иметь тесты для функций статистики и аналитики, чтобы убедиться в корректности расчетов.

#### Критерии Приемки

1. Система ДОЛЖНА содержать тесты для расчета процента выполнения
2. Система ДОЛЖНА содержать тесты для расчета streak
3. Система ДОЛЖНА содержать тесты для расчета статистики по категориям
4. Система ДОЛЖНА содержать тесты для генерации графиков
5. Система ДОЛЖНА содержать property-based тесты для граничных случаев

### Требование 15: Тестирование Комментариев

**Пользовательская История:** Как разработчик, я хочу иметь тесты для функций комментариев, чтобы обеспечить их надежность.

#### Критерии Приемки

1. Система ДОЛЖНА содержать тесты для добавления комментариев
2. Система ДОЛЖНА содержать тесты для редактирования комментариев
3. Система ДОЛЖНА содержать тесты для удаления комментариев
4. Система ДОЛЖНА содержать тесты для поиска комментариев
5. Система ДОЛЖНА содержать property-based тесты для валидации комментариев
